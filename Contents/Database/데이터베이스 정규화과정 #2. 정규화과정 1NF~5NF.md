## 정규화 과정

<p align="center"><img src="https://i.postimg.cc/4x240jx0/image.png" width="400"></p>

**두부이걸다줘? ----> 도부이결다조**
  
> **함수적 종속 관계**
> 
> 어떤 릴레이션 R에서 속성 X의 값 각각에 대해 속성 Y의 값이 하나만 연관되는 관계를 Y는 X에 함수 종속적이라고 하며, X(결정자) → Y(종속자)로 표현한다.
> 
> ex) '수강' 릴레이션이 학번, 이름, 과목명 속성으로 구성되어 있을 때, 학번이 결정되면 과목명에 상관없이 학번에는 항상 같은 이름이 대응된다. 학번에 따라 이름이 결정될 때 '학번 → 이름' 으로 표현한다.
> 
> **이행적 종속 관계**
> 
>  A → B 이고, B → C 일 때, A → C 를 만족하는 관계

## 정규화의 장점

- 데이터베이스 변경 시 이상 현상(Anomaly)을 제거할 수 있다.
  
- 정규화된 데이터베이스 구조에서는 새로운 데이터 형의 추가로 인한 확장 시, 그 구조를 변경하지 않아도 되거나 일부만 변경해도 된다.
  
- 데이터베이스와 연동된 응용 프로그램에 최소한의 영향만을 미치게 되어 응용프로그램의 생명을 연장시킨다.
  

## 정규화의 단점

- 릴레이션의 분해로 인해 릴레이션 간의 JOIN연산이 많아진다.
  
- 질의에 대한 응답 시간이 느려질 수도 있다. 데이터의 중복 속성을 제거하고 결정자에 의해 동일한 의미의 일반 속성이 하나의 테이블로 집약되므로 한 테이블의 데이터 용량이 최소화되는 효과가 있다. 따라서 데이터를 처리할 때 속도가 빨라질 수도 있고 느려질 수도 있다.
  
- 만약 조인이 많이 발생하여 성능 저하가 나타나면 **반정규화(De-normalization)** 를 적용할 수도 있다.

## 제 1 정규형(1NF)

### 제 1 정규형 규칙

- 각 칼럼이 하나의 속성만을 가져야 한다.
  
- 하나의 칼럼은 같은 종류나 타입(type)의 값을 가져야 한다.
  
- 각 컬럼이 유일한(unique) 이름을 가져야 한다.
  
- 칼럼의 순서가 상관없어야 한다.
  

### 예시)

<p align="center"><img src="https://i.postimg.cc/cCYCfh7J/img1-daumcdn.png" ></p>

1. 각 컬럼이 하나의 값(속성)만을 가져야 한다. -> **불만족! 하나의 칼럼(과목)에 두 개의 값을 가짐**
2. 하나의 컬럼은 같은 종류나 타입(type)의 값을 가져야 한다. -> **만족**
3. 각 컬럼이 유일한(unique) 이름을 가져야 한다. -> **만족**
4. 칼럼의 순서가 상관없어야 한다. -> **만족**

<p align="center"><img src="https://i.postimg.cc/brdM5VVz/img1-daumcdn.png" ></p>

위와 같이 각 칼럼이 원자 값을 갖도록 테이블을 분해하면 1 정규형을 만족하게 바꿀 수 있다.

## 제 2 정규형(2NF)

### 제 2 정규형 규칙

- 제 1 정규형을 만족해야 한다.
  
- 모든 컬럼이 부분적 종속(Partial Dependency)이 없어야 한다.
  
- 모든 칼럼이 완전 함수 종속을 만족해야 한다.
  

> 부분적 종속이란 기본키 중에 특정 컬럼에만 종속되는 것이다. 
> 
> 완전 함수 종속이란 기본키의 부분집합이 결정자가 되어선 안된다는 것이다. ( 비슷한 말이다 )

### 예시)

<p align="center"><img src="https://i.postimg.cc/jqp2hpFd/img1-daumcdn.png" ></p>

위와 같은 테이블이 있다고 가정해보면 성적의 특정 값을 알기 위해서는 학생 번호+과목이 있어야 한다. (ex : 102번의 자바 성적 70 )

하지만 특정 과목의 지도교수는 과목명만 알면 지도교수가 누군지 알 수 있다. (ex : 자바의 지도교수 박자바)

위 테이블에서 기본키는 (학생 번호, 과목)으로 복합키이다. 

그런데 이때 지도교수 칼럼은 (학생 번호, 과목)에 종속되지 않고 (과목) 에만 종속되는 부분적 종속이다.

따라서 제2 정규화를 만족하지 않으므로 아래와 같이 분해해야 한다.

<p align="center"><img src="https://i.postimg.cc/T38bpL60/img1-daumcdn.png"></p>

위와 같이 분해하면 제2 정규형을 만족한다.

## 제 3 정규형(3NF)

### 제 3 정규형 규칙

- 제2 정규형을 만족해야 한다.
  
- 기본키를 제외한 속성들 간의 이행 종속성 (Transitive Dependency)이 없어야 한다.
  

> 이행 종속성이란 A->B, B->C 일 때 A->C 가 성립하면 이행 종속이라고 한다.

### 예시)

<p align="center"><img src="https://i.postimg.cc/tJqygHRp/img1-daumcdn.png" ></p>

위와 같은 테이블을 보면 ID를 알면 등급을 알 수 있다. 등급을 알면 할인율을 알 수 있다. 따라서 ID를 알면 할인율을 알 수 있다. 따라서 이행 종속성이 존재하므로 제 3 정규형을 만족하지 않는다.

제 3 정규형을 만족하기 위해서는 아래와 같이 분해해야 한다.

<p align="center"><img src="https://i.postimg.cc/xCspKry0/img1-daumcdn.png"></p>

위와 같이 분해하면 제 3정규형을 만족한다.

## BCNF (Boyce-Codd Normal Form)

**제 3 정규형을 강화한 버전**

### BCNF 규칙

- 제 3 정규형을 만족해야 한다.
  
- 모든 결정자가 후보키 집합에 속해야 한다.
  

> 모든 결정자가 후보키 집합에 속해야 한다는 뜻은, 후보키 집합에 없는 칼럼이 결정자가 되어서는 안 된다는 뜻이다.

### 예시)

<p align="center"><img src="https://i.postimg.cc/hGn70fpr/img1-daumcdn.png"></p>

위와 같은 테이블을 보자. (학생 번호, 과목)이 기본키로 지도교수를 알 수 있다. 하지만 같은 과목을 다른 교수가 가르칠 수도 있어서 과목-> 지도교수 종속은 성립하지 않는다. 하지만 지도교수가 어떤 과목을 가르치는지는 알 수 있으므로 지도교수-> 과목 종속이 성립한다.

이처럼 후보키 집합이 아닌 칼럼이 결정자가 되어버린 상황을 BCNF를 만족하지 않는다고 한다. 

BCNF를 만족하기 위해서는 아래와 같이 분해하면 된다.

<p align="center"><img src="https://i.postimg.cc/85RGmzXh/img1-daumcdn.png"></p>

참고로 위에서 학생 번호와 지도교수는 다치 종속성이 발생하게 되는데, 이는 제4 정규형에서 다뤄진다.

보통 정규화는 BCNF 까지만 하는 경우가 많다. 그 이상 정규화를 하면 정규화의 단점이 나타날 수도 있다.

## 제 4 정규형(4NF)

### 제 4 정규형 규칙

- BCNF를 만족해야 한다.
  
- 다치 종속(Multi-valued Dependency)이 없어야 한다.
  

#### 다치 종속 조건

-  A->B 일 때 하나의 A값에 여러 개의 B값이 존재하면 다치 종속성을 가진다고 하고 A↠B라고 표시한다.
  
- 최소 3개의 칼럼이 존재한다.
  
- R(A, B, C)가 있을 때 A와 B 사이에 다치 종속성이 있을 때 B와 C가 독립적이다.
  

### 예시)

<p align="center"><img src="https://i.postimg.cc/mZ1gp7hS/img1-daumcdn.png"></p>

위와 같은 테이블을 보면 101번 학생은 자바와 C++ 과목을 수강하고, 노래와 게임을 취미로 가진다. 

이렇게 되면 학생 번호 하나에 과목 여러 개와 취미 여러 개가 종속된다. 이런 경우 학생 번호를 토대로 값을 조회하면 아래와 같이 중복이 발생하게 된다.

<p align="center"><img src="https://i.postimg.cc/ydByp7ym/img1-daumcdn.png"></p>

과목과 취미는 관계가 없는 독립적인 관계이다. 하지만 같은 테이블의 학생 번호라는 칼럼에 다치 종속되어버려 중복이 발생하는 문제가 생긴다.

4NF를 만족하기 위해서는 아래와 같이 분해하면 된다.

<p align="center"><img src="https://i.postimg.cc/cCV59V9f/img1-daumcdn.png"></p>

위 2개의 테이블은 여전히 다치 종속성을 가지지만, 2개 이상의 칼럼이 하나의 칼럼에 다치 종속되지는 않기 때문에 제4 정규형을 만족한다.

## 제 5 정규형(5NF)

제5 정규형은 중복을 제거하기 위해 분해할 수 있을 만큼 전부 분해하는 것이다. 이러한 5NF는 Project Join Normal Form(PJNF)라고도 불린다.

### 제 5 정규형 규칙

- 4NF를 만족해야 한다.
  
- 조인 종속(Join dependency)이 없어야 한다.
  
- 조인 연산을 했을 때 손실이 없어야 한다.
  

### 예시)

조인 종속은 다치 종속의 좀 더 일반화된 형태이다. 만약 하나의 릴레이션을 여러 개의 릴레이션으로 무손실 분해했다가 다시 결합할 수 있다면 조인 종속이라고 한다.

<p align="center"><img src="https://i.postimg.cc/K8X8BjN8/img1-daumcdn.png"></p>

예를 들어 A라는 릴레이션을 B와 C로 분해했다가 다시 조인했을 때 그대로 A가 된다면, A는 조인 종속성이 있다고 한다.

일반적으로 현실의 데이터베이스에서는 제 5 정규형을 사용하지 않는다.

## 문제
1. 정규화 과정 중 1NF에서 2NF가 되기 위한 조건은?<br>
[정답률: 22%] 정보처리기사(2020년 이후) 필기 (2020년 1회·2회 통합 기출문제)<br>
① 1NF를 만족하고 모든 도메인이 원자값이어야 한다.	 <br>
② 1NF를 만족하고, 키가 아닌 모든 애트리뷰트들이 기본키에 이행적으로 함수 종속되지 않아야 한다.	 <br>
③ 1NF를 만족하고 다치 종속이 제거되어야 한다.	 <br>
④ 1NF를 만족하고 키가 아닌 모든 속성이 기본키에 대하여 완전 함수적 종속 관계를 만족해야 한다.<br>

2. 이행적 함수 종속 관계를 의미하는 것은?<br>
[정답률: 83%] 정보처리기사(2020년 이후) 필기 (2020년 1회·2회 통합 기출문제)<br>
① A→B이고 B→C일 때, A→C를 만족하는 관계<br>
② A→B이고 B→C일 때, C→A를 만족하는 관계	 <br>
③ A→B이고 B→C일 때, B→A를 만족하는 관계	 <br>
④ A→B이고 B→C일 때, C→B를 만족하는 관계<br>
  
3. 릴레이션 R의 모든 결정자(determinant)가 후보키이면 그 릴레이션 R은 어떤 정규형에 속하는가? <br>
[정답률: 63%] 정보처리기사(2020년 이후) 필기 (2020년 3회 기출문제)<br>
① 제1 정규형	 <br>
② 제2 정규형	 <br>
③ 보이스/코드 정규형<br>
④ 제4 정규형<br>
  
4. 정규화의 목적으로 옳지 않은 것은?<br>
[정답률: 68%] 정보처리기사(2020년 이후) 필기 (2020년 3회 기출문제)<br>
① 어떠한 릴레이션이라도 데이터베이스 내에서 표현 가능하게 만든다.	 <br>
② 데이터 삽입 시 릴레이션을 재구성할 필요성을 줄인다.	 <br>
③ 중복을 배제하여 삽입, 삭제, 갱신 이상의 발생을 야기한다.<br>	
④ 효과적인 검색 알고리즘을 생성할 수 있다.<br>

5. 다음과 같이 위쪽 릴레이션을 아래쪽 릴레이션으로 정규화를 하였을 때 어떤 정규화 작업을 한 것인가?<br>
[정답률: 33%] 정보처리기사(2020년 이후) 필기 (2020년 3회 기출문제)<br>
① 제1정규형	<br>
② 제2정규형	 <br>
③ 제3정규형	 <br>
④ 제4정규형	<br>
 
6. 릴레이션 조작 시 데이터들이 불필요하게 중복되어 예기치 않게 발생하는 곤란한 현상을 의미하는 것은? <br>
[정답률: 30%] 정보처리기사(2020년 이후) 필기 (2020년 3회 기출문제)<br>
① normalization	 <br>
② rollback	 <br>
③ cardinality	 <br>
④ anomaly<br>
  
7. 정규화된 엔티티, 속성, 관계를 시스템의 성능 향상과 개발 운영의 단순화를 위해 중복, 통합, 분리 등을 수행하는 데이터 모델링 기법은? <br>
[정답률: 27%] 정보처리기사(2020년 이후) 필기 (2020년 4회 기출문제)<br>
① 인덱스정규화	 <br>
② 반정규화	<br>
③ 집단화	 <br>
④ 머징<br>
 
